---
title: 进程间的通信方式
updated: 2025-08-22T18:59:02
created: 2025-04-15T11:15:01
---

### 管道 (Pipe)
- 描述：管道是一种半双工的通信方式，数据只能单向流动。它本质上是**内核维护的一个缓冲区**。
- 类型：
  #### 匿名管道 (Anonymous Pipes)：
    - 只能用于具有亲缘关系的进程之间（如父子进程、兄弟进程）。
    - 生命周期随进程结束而结束。
    - 在 Shell 中，竖线\|就是匿名管道，例如ls \| grep "txt"将ls的输出作为grep的输入。
  #### 命名管道 (Named Pipes / FIFO)**：
    - 通过一个磁盘上的文件名（节点）来标识，不依赖于亲缘关系。
    - 任何进程都可以通过知道这个文件名来打开并进行读写。
    - 创建后一直存在于文件系统中，除非被显式删除。
- 优点：简单易用。
- 缺点：效率相对较低，且匿名管道只能单向通信。
### 消息队列 (Message Queue)
- 描述：消息队列是**存放在内核中的链表**。进程可以向队列中添加消息（写），也可以从队列中读取消息（读）。每个消息都是一个数据块，有特定的格式和优先级。
- 特点：
  - 独立于进程：消息队列独立于发送和接收进程而存在。进程终止后，消息队列及其内容并不会被自动删除，需要显式地命令删除或系统重启。
  - 面向记录：消息有特定的格式和优先级，接收进程可以按消息的类型读取，而不一定是先进先出。
- 优点：避免了管道和命名管道中的同步和阻塞问题。
- 缺点：消息大小有上限，且**存在用户态与内核态之间的数据拷贝开销**。
### 共享内存 (Shared Memory)
- 描述：这是**最快的 IPC 方式**。它使得多个进程可以访问同一块物理内存空间。一个进程将内存区域映射到自己的地址空间，写入数据后，其他映射了同一内存区域的进程可以立即看到更改。
- 工作流程：
  - 由一个进程创建或获取一块共享内存段。
  - 各个需要通信的进程将此内存段附加（映射）到自己的地址空间。
  - 进程像操作普通内存一样读写该区域。
  - 通信完毕后，进程分离该内存段。
- 优点：极快的速度，因为数据不需要在内核和用户空间之间来回拷贝。
- 缺点：需要**额外的同步机制**（如信号量、互斥锁）来保护共享资源，防止多个进程同时写入导致数据混乱（竞态条件）。
### 信号量 (Semaphore)
- 描述：信号量本质上是一个`计数器`，用于控制多个进程对共享资源的访问。它**主要用于进程间同步，而不是直接传递数据**，通常与共享内存等其他 IPC 方式配合使用。
- 操作：
  - P 操作（等待，==sem_wait==）：如果信号量的值大于零，则将其减一；如果值为零，则进程阻塞，直到值大于零。
  - V 操作（发送，==sem_post==）：将信号量的值加一，并唤醒等待该信号量的进程。
- 类比：信号量就像一把钥匙，访问资源前必须先拿到钥匙（P操作），用完后归还（V操作）。如果钥匙被借光了，后来的进程就必须等待。
### 信号 (Signal)
- 描述：信号是进程间通信机制中**唯一的异步通信方式**。用于通知接收进程某个事件已经发生（例如，用户按下了Ctrl+C会发送SIGINT信号，进程被强制终止SIGKILL）。
- 特点：
  - 复杂度低，不能携带大量信息。
  - 主要用于中断、管理进程，而不是常规的数据交换。
- 示例：kill -9 命令就是向指定进程 ID 发送SIGKILL信号。
###  套接字 (Socket)
- 描述：套接字是功能最强大、最通用的 IPC 机制。它不仅可以用于同一台机器上的进程间通信，更`主要用于不同机器之间的网络通信`。
  #### 类型：
  - 网络套接字：基于 TCP/IP 或 UDP 协议，进行网络通信。
  - Unix 域套接字 (Unix Domain Socket)：用于同一台主机上的进程间通信。它通过文件系统路径名来标识，避免了网络协议栈的开销，效率比网络套接字高，比管道和消息队列也更灵活可靠。
- 优点：通用、跨网络、可跨语言。
- 缺点：设置和使用相对复杂。
