---
title: 数据库相关
updated: 2025-04-14T22:02:56
created: 2025-04-14T22:00:50
---

1、 什么是数据库连接池，为什么要创建连接池？
（1）池是资源的容器，这组资源在服务器启动之初就被完全创建好并初始化，本质上是**对资源的复用**。
当系统开始处理客户请求的时候，如果它需要相关的资源，可以直接从池中获取，无需动态分配；当服务器处理完一个客户连接后,可以把相关的资源放回池中，无需执行系统调用释放资源。
（2）若系统需要**频繁访问数据库**，则需要频繁创建和断开数据库连接，而创建数据库连接是一个很耗时的操作，也容易对数据库造成安全隐患。
在程序初始化的时候，集中创建多个数据库连接，并把他们集中管理，供程序使用，可以保证较快的数据库读写速度，更加安全可靠。
（3）使用**单例模式和链表创建数据库连接池**，实现对数据库连接资源的复用。
连接池的功能主要有：初始化，获取连接、释放连接，销毁连接池
连接池中的多线程使用信号量进行通信，使用**互斥锁**进行同步。

数据库连接的获取与释放通过**RAII机制**封装，避免手动释放。
==RAII机制==
== RAII全称是“Resource Acquisition is Initialization”，直译过来是“资源获取即初始化”.==
== RAII的核心思想是将资源或者状态与对象的生命周期绑定，通过C++的语言机制，实现资源和状态的安全管理,**智能指针**是RAII最好的例子==
== 具体来说：**构造函数的时候初始化获取资源，析构函数释放资源**==
**3、登录说一下？（登录注册是POST请求）**
将数据库中的用户名和密码载入到服务器的map中来，**map中的key为用户名，value为密码**
服务器端解析浏览器的请求报文，当解析为POST请求时，提取出请求报文的消息体的用户名和密码。
POST请求中最后是用户名和密码，用&隔开。分隔符&，前是用户名，后是密码。
登录：将浏览器输入的用户名和密码在数据库中查找，直接判断。
注册：往数据库中插入数据，需要判断是否有重复的用户名。
最后进行页面跳转
4、登录与注册，服务器如何校验
CGI校验（通用网关接口），它是一个运行在Web服务器上的程序，在编译的时候将相应的.cpp文件编程成.cgi文件并在主程序中调用即可。这些CGI程序通常通过客户在其浏览器上点击一个button时运行。这些程序通常用来执行一些信息搜索、存储等任务，而且通常会生成一个动态的HTML网页来响应客户的HTTP请求。
CGI程序，将用户请求中的用户名和密码保存在一个id_passwd.txt文件中，通过将数据库中的用户名和密码存到一个map中用于校验。在主程序中通过execl(m_real_file, &flag, name, password, NULL);这句命令来执行这个CGI文件，这里CGI程序仅用于校验，并未直接返回给用户响应。这个CGI程序的运行通过多进程来实现，根据其返回结果判断校验结果（使用pipe进行父子进程的通信，子进程将校验结果写到pipe的写端，父进程在读端读取）。
**
